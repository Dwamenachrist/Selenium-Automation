<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Download You Media</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap">
  <style>
    :root {
      --primary: #e50914;
      --primary-hover: #f40612;
      --secondary: #032541;
      --text: #333;
      --text-light: #eee;
      --bg-light: #f8f9fa;
      --bg-dark: #141414;
      --card-light: #ffffff;
      --card-dark: #1f1f1f;
      --border-light: #e6e6e6;
      --border-dark: #333;
      --success: #01b4e4;
      --downloaded: rgba(1, 180, 228, 0.15);
      --shadow-light: 0 8px 30px rgba(0, 0, 0, 0.12);
      --shadow-dark: 0 8px 30px rgba(0, 0, 0, 0.3);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      --subtitle-color: #01b4e4;
      --video-color: #e67e22;
      --other-color: #9b59b6;
      --hd-color: #27ae60;
      --sd-color: #f39c12;
      --lq-color: #95a5a6;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background-color: var(--bg-light);
      color: var(--text);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      transition: var(--transition);
    }

    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background-color: var(--secondary);
      color: white;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo span {
      color: var(--primary);
    }

    .logo-icon {
      margin-right: 10px;
      font-size: 2rem;
    }

    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem 1rem;
    }

    .container {
      width: 100%;
      max-width: 800px;
      background: var(--card-light);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: var(--shadow-light);
      transition: var(--transition);
    }

    h1 {
      margin-bottom: 1.5rem;
      font-weight: 600;
      font-size: 1.8rem;
      text-align: center;
    }

    h2 {
      font-size: 1.4rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-container {
      display: flex;
      gap: 10px;
      margin-bottom: 1.5rem;
    }

    input[type=text] {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid var(--border-light);
      border-radius: 8px;
      font-size: 1rem;
      transition: var(--transition);
      font-family: inherit;
    }

    input[type=text]:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(229, 9, 20, 0.2);
    }

    button {
      padding: 12px 20px;
      border: none;
      background-color: var(--primary);
      color: white;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    button:hover {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(0);
    }

    .season-container {
      margin-bottom: 2rem;
    }

    .season-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: var(--secondary);
      color: white;
      padding: 12px 16px;
      border-radius: 8px 8px 0 0;
      cursor: pointer;
    }

    .season-header:hover {
      background-color: #043b63;
    }

    .season-content {
      border: 2px solid var(--border-light);
      border-top: none;
      border-radius: 0 0 8px 8px;
      overflow: hidden;
      transition: var(--transition);
      max-height: 0;
      overflow: hidden;
    }

    .season-content.open {
      max-height: 500px;
      overflow-y: auto;
    }

    .episode-list-container {
      margin: 1.5rem 0;
      border-radius: 12px;
      border: 2px solid var(--border-light);
      overflow: hidden;
      transition: var(--transition);
    }

    .episode-list-header {
      background-color: var(--secondary);
      color: white;
      padding: 12px 16px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
    }

    .selection-controls {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .selection-controls button {
      padding: 8px 12px;
      font-size: 0.85rem;
      background-color: var(--secondary);
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 350px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--primary) var(--bg-light);
    }

    ul::-webkit-scrollbar {
      width: 8px;
    }

    ul::-webkit-scrollbar-track {
      background: var(--bg-light);
    }

    ul::-webkit-scrollbar-thumb {
      background-color: var(--primary);
      border-radius: 20px;
    }

    li {
      padding: 16px;
      border-bottom: 1px solid var(--border-light);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
    }

    li:last-child {
      border-bottom: none;
    }

    li:hover {
      background-color: rgba(229, 9, 20, 0.05);
    }

    li.downloaded {
      background-color: var(--downloaded);
    }

    li input[type="checkbox"] {
      margin-right: 12px;
      width: 18px;
      height: 18px;
      accent-color: var(--primary);
    }

    .media-type {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-left: 8px;
      color: white;
    }

    .media-type.subtitle {
      background-color: var(--subtitle-color);
    }

    .media-type.video {
      background-color: var(--video-color);
    }

    .media-type.other {
      background-color: var(--other-color);
    }

    .resolution-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-left: 8px;
      color: white;
    }

    .resolution-badge.hd {
      background-color: var(--hd-color);
    }

    .resolution-badge.sd {
      background-color: var(--sd-color);
    }

    .resolution-badge.lq {
      background-color: var(--lq-color);
    }

    .resolution-selector {
      display: flex;
      gap: 5px;
      margin-left: auto;
    }

    .resolution-btn {
      padding: 2px 8px;
      font-size: 0.8rem;
      border-radius: 4px;
      background-color: var(--secondary);
      opacity: 0.7;
      cursor: pointer;
    }

    .resolution-btn:hover {
      opacity: 1;
      transform: translateY(-1px);
    }

    .resolution-btn.hd {
      background-color: var(--hd-color);
    }

    .resolution-btn.sd {
      background-color: var(--sd-color);
    }

    .resolution-btn.lq {
      background-color: var(--lq-color);
    }

    .resolution-btn.active {
      opacity: 1;
      transform: translateY(-1px);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 1.5rem;
      gap: 10px;
      flex-wrap: wrap;
    }

    .download-btn {
      background: var(--primary);
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
    }

    .toggle-btn {
      background: var(--secondary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .toggle-btn:hover {
      background: #043b63;
    }

    .progress {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--text);
      text-align: center;
      height: 24px;
      transition: var(--transition);
    }

    .progress-bar {
      height: 6px;
      width: 100%;
      background-color: var(--border-light);
      border-radius: 3px;
      margin-top: 8px;
      overflow: hidden;
      display: none;
    }

    .progress-bar-fill {
      height: 100%;
      background-color: var(--primary);
      width: 0%;
      transition: width 0.3s ease;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--success);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    .selected-count {
      background: var(--secondary);
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      margin-left: 8px;
    }

    .range-container {
      display: flex;
      gap: 10px;
      margin-bottom: 1rem;
    }

    .download-settings {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      transition: var(--transition);
    }

    .download-settings h3 {
      margin-bottom: 0.5rem;
      font-size: 1rem;
    }

    .setting-row {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .setting-row label {
      flex: 1;
    }

    .setting-row input[type="range"] {
      width: 150px;
    }

    .setting-value {
      width: 50px;
      text-align: right;
      margin-left: 10px;
    }

    .season-badge {
      background-color: var(--primary);
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      margin-left: 8px;
    }

    .chevron {
      transition: transform 0.3s ease;
    }

    .chevron.open {
      transform: rotate(180deg);
    }

    .tabs {
      display: flex;
      margin-bottom: 1.5rem;
      border-bottom: 2px solid var(--border-light);
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: var(--transition);
      font-weight: 600;
    }

    .tab.active {
      border-bottom-color: var(--primary);
      color: var(--primary);
    }

    .filter-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 8px 12px;
      font-size: 0.85rem;
      background-color: var(--secondary);
      opacity: 0.7;
    }

    .filter-btn.active {
      opacity: 1;
      transform: translateY(-2px);
    }

    .filter-btn.subtitle {
      background-color: var(--subtitle-color);
    }

    .filter-btn.video {
      background-color: var(--video-color);
    }

    .filter-btn.other {
      background-color: var(--other-color);
    }

    .resolution-settings {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      transition: var(--transition);
    }

    .resolution-settings h3 {
      margin-bottom: 0.5rem;
      font-size: 1rem;
    }

    .resolution-options {
      display: flex;
      gap: 10px;
      margin-top: 0.5rem;
    }

    .resolution-option {
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: var(--transition);
      border: 2px solid transparent;
    }

    .resolution-option.active {
      border-color: var(--primary);
    }

    .resolution-option.hd {
      background-color: rgba(39, 174, 96, 0.1);
      color: var(--hd-color);
    }

    .resolution-option.sd {
      background-color: rgba(243, 156, 18, 0.1);
      color: var(--sd-color);
    }

    .resolution-option.lq {
      background-color: rgba(149, 165, 166, 0.1);
      color: var(--lq-color);
    }

    .preview-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .preview-container.active {
      opacity: 1;
      pointer-events: all;
    }

    .preview-content {
      max-width: 90%;
      max-height: 90%;
      background-color: var(--card-light);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background-color: var(--secondary);
      color: white;
    }

    .preview-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
    }

    .preview-body {
      padding: 16px;
      max-height: 70vh;
      overflow-y: auto;
    }

    .preview-video {
      width: 100%;
      max-height: 70vh;
    }

    .preview-subtitle {
      font-family: monospace;
      white-space: pre-wrap;
      padding: 16px;
      background-color: var(--bg-light);
      border-radius: 4px;
      max-height: 60vh;
      overflow-y: auto;
    }

    /* Dark mode styles */
    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-light);
    }

    body.dark .container {
      background-color: var(--card-dark);
      box-shadow: var(--shadow-dark);
    }

    body.dark input[type=text] {
      background-color: #2b2b2b;
      border-color: var(--border-dark);
      color: var(--text-light);
    }

    body.dark .episode-list-container {
      border-color: var(--border-dark);
    }

    body.dark .season-content {
      border-color: var(--border-dark);
    }

    body.dark li {
      border-color: var(--border-dark);
    }

    body.dark li:hover {
      background-color: rgba(229, 9, 20, 0.15);
    }

    body.dark .progress-bar {
      background-color: #333;
    }

    body.dark .download-settings, 
    body.dark .resolution-settings {
      border-color: var(--border-dark);
    }

    body.dark .tabs {
      border-color: var(--border-dark);
    }

    body.dark .preview-content {
      background-color: var(--card-dark);
    }

    body.dark .preview-subtitle {
      background-color: #2b2b2b;
      color: var(--text-light);
    }

    /* Animation keyframes */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Responsive styles */
    @media (max-width: 768px) {
      .container {
        padding: 1.5rem;
      }

      .search-container, .range-container {
        flex-direction: column;
      }

      button {
        width: 100%;
      }

      .actions {
        flex-direction: column;
        gap: 1rem;
      }

      .toggle-btn, .download-btn {
        width: 100%;
      }

      .selection-controls, .filter-controls {
        flex-direction: column;
      }

      .resolution-options {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <h1 class="logo">
        <span class="logo-icon">🎬</span>
        <span>You</span><span>Media</span>
      </h1>
    </header>

    <main>
      <div class="container">
        <h1>Download You Media</h1>
        
        <div class="tabs">
          <div class="tab active" data-tab="all">All Episodes</div>
          <div class="tab" data-tab="seasons">By Season</div>
        </div>
        
        <div class="search-container">
          <input type="text" id="searchInput" placeholder="Search episodes...">
        </div>
        
        <div class="range-container">
          <input type="text" id="rangeInput" placeholder="Enter range (e.g., S01E02-S01E05 or S02E07)">
          <button onclick="selectRange()">Select Range</button>
        </div>
        
        <div class="filter-controls">
          <button id="filterAll" class="filter-btn active" onclick="filterMedia('all')">All Media</button>
          <button id="filterSubtitle" class="filter-btn subtitle" onclick="filterMedia('subtitle')">Subtitles</button>
          <button id="filterVideo" class="filter-btn video" onclick="filterMedia('video')">Videos</button>
          <button id="filterOther" class="filter-btn other" onclick="filterMedia('other')">Other</button>
        </div>
        
        <div class="resolution-settings">
          <h3>Preferred Video Resolution</h3>
          <p>Select your preferred resolution for video downloads:</p>
          <div class="resolution-options">
            <div id="resHD" class="resolution-option hd active" onclick="setPreferredResolution('hd')">HD (720p+)</div>
            <div id="resSD" class="resolution-option sd" onclick="setPreferredResolution('sd')">SD (480p)</div>
            <div id="resLQ" class="resolution-option lq" onclick="setPreferredResolution('lq')">Low Quality</div>
          </div>
        </div>
        
        <div class="selection-controls">
          <button onclick="selectAll()">Select All</button>
          <button onclick="deselectAll()">Deselect All</button>
          <span id="selectedCount" class="selected-count">0 selected</span>
        </div>
        
        <div id="allEpisodesView">
          <div class="episode-list-container">
            <div class="episode-list-header">
              <span>All Episodes</span>
              <span id="episodeCount">40 Episodes</span>
            </div>
            <ul id="episodeList">
              <!-- Episodes will be populated here -->
            </ul>
          </div>
        </div>
        
        <div id="seasonsView" style="display: none;">
          <div id="seasonContainers">
            <!-- Season containers will be generated here -->
          </div>
        </div>
        
        <div class="download-settings">
          <h3>Download Settings</h3>
          <div class="setting-row">
            <label for="downloadDelay">Delay between downloads (ms):</label>
            <input type="range" id="downloadDelay" min="100" max="2000" step="100" value="500">
            <span id="delayValue" class="setting-value">500</span>
          </div>
        </div>
        
        <div class="progress">
          <span id="progressText"></span>
          <div class="progress-bar" id="progressBar">
            <div class="progress-bar-fill" id="progressBarFill"></div>
          </div>
        </div>
        
        <div class="actions">
          <button class="download-btn" onclick="downloadSelected()">
            <span>⬇️</span>
            <span>Download Selected</span>
          </button>
          
          <button class="toggle-btn" onclick="toggleDarkMode()">
            <span id="themeIcon">🌙</span>
            <span id="themeText">Dark Mode</span>
          </button>
        </div>
      </div>
    </main>

    <div class="toast" id="toast">
      <span>✅</span>
      <span id="toastMessage"></span>
    </div>
    
    <div class="preview-container" id="previewContainer">
      <div class="preview-content">
        <div class="preview-header">
          <h3 id="previewTitle">Preview</h3>
          <button class="preview-close" onclick="closePreview()">×</button>
        </div>
        <div class="preview-body" id="previewBody">
          <!-- Preview content will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // Episode data structure - placeholder for demo
    // In a real implementation, this would be populated with actual data
    const episodes = [
  {
    "season": 4,
    "episode": 1,
    "url": "https://cacdn.hakunaymatata.com/subtitle/750ee362bc4b98969f189d682c5abc29.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MzM3fX19XX0_&Signature=PUpxdNa2ULQe-YqK4cNKAtxPpzBh6phap9x4RF8zTWB2pmIa54rY09yeub0L4WX6kvNaTVSElkOhEK3wGUyjIf7ltot2wcAnp69d2H5LqnwlFX8gRU7Dof9RGwUA92EfV6BV6-txO0sGchBW-WCJhA3lMjjJvX6w~SE07C8UGViOenGG5jn3Pjo3cd5EusJ4d7Wnd4QCTTmMkDkt3TxugujGqFSeJAnayCIHfm~Jsusx7jKoTUQP1GF-B9hvKDhAI2i~MFsvJ-YKg9dJ~a31lV9u8EpXfQffoeh7bJCeA1Pgp7kskXzsXyM1gkrjWGCDJPh4I-aQ~a3Hzze~~IBHrA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E01.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 1,
    "url": "https://macdn.hakunaymatata.com/bt/d29cc6db50224ca73df63e86e4183f13.mp4?Expires=1747232891&Signature=yadMv6Sy5o69E4MF2wf1Em-hzSwYSnzoXxYq8DCwz9TSIdHFc~gqeY3fAs~rxrgTw6yCPtyEkYB8VmGMhLeisGB~mL216M1EsyVLzZOwbLfJtQ7P10K2ZtcGaXJ44~C2elujXGs2pejnBK85GoB2Ln5ySd28CJlDDOx1uSeOLESZ9JVE8QO24vhUMVNZXr-PQ3nUZ2QyOH4JzbwGPKqmQ~gl6osKNu5T2VhrCi32xU4ASMv9EFz9uUnS2XfdN1cpaASKHgydlKE33MEKeZBSv1fWnJDZbJ-YEBkH3iysUDvybHxmPEYkHIB2ar4UAkO04~NMfAkstITf5-hHJ3UBfw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E01_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 2,
    "url": "https://cacdn.hakunaymatata.com/subtitle/31b92dcd31f5848aba3ca0aa4fbb8e79.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI3MTg3fX19XX0_&Signature=GZol-2tr3ciXt5yweZ6KuWVFp5K~3xV~WmY45EDmbyaG5S~H1iDRUYCVfYcbYNjGpqKIWyJaB37fDrf8P~MJcrMRcXjZulVPK3YqT3nN0pukSmsA2hUko7QzcKkmDy16NriGefydAnZOgOfMqeEqLapM3l4N0z8ep6rAPqU7YHCkp5URAlJBzj7X4J3-M8xK1EnxPbuOF6VtE9aI4akzMesuTvJuzK6z5cbCObhOIlJymFTJuSuPRixVSaTyCrFlhiubkX4QLYz7xNjjSV4UtYC7CSg3yrLjzzbvX85DPczsV-dLOPQXr~WTVkWEnLN5HwAMghHP~8l5fY-WPciCPA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E02.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 2,
    "url": "https://macdn.hakunaymatata.com/resource/c799ef6c2f66c927bcbff039988d3274.mp4?Expires=1747233133&Signature=cA2D9OB4Vz1qCHW~prZ9hRThrsZSMcT007oKpzuFj9aweTrSPHgyOZJtqoR9VAmrNoJMsGnEzXRLvnIexleOrOVHKqoZJ71S6~ay8MZHP8466TQqe2ohvS91wT8Gezfkdh5ZRjxIruOHKcBKwBt8Ik1TNpp~m~5Oft7pOWuRNIG2WXBmuI2AC-CDZlanKqSGlj4yZc67dyNrl4RLJRKZtYggW3zB2HzLurJ2qgQuMLL~1liuKv-Z0svJxN8JazKNS1tiJnNZJs6IVlg~G0QAdGklUSoxqwpj3gDsQEyZ9Ujl8QwtTkvc-KfAAmRjJ9sK4Qq-E5qxf4CpR4AWm6k35Q__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E02_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 3,
    "url": "https://cacdn.hakunaymatata.com/subtitle/accfe5e523bd1072aed3542082190d01.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E03.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 3,
    "url": "https://macdn.hakunaymatata.com/resource/f3b97a73eac11dabd8fd15a12b8edba7.mp4?Expires=1747234695&Signature=W68rH~t4~7UPJ7hqJbRqAGSAONQm5ST5nT7V722xsyMmL5LI-nSUp~0KkptOogMNHOfJDpcs2FDkd7G2wG6czNod8ntjQwDw0t0NtQ22XUA1ipNHPFucq9bw0ZcUqL~uCDdQrVqwVzFWyVsPXKpPI2CitBWE5SDUHCHBuvQNTiJ1qLGYOqASO9-a-T71ocvBaN1MUdkpQJIekOOdjBMFvvhJ7fVBUr9yI0rMYVry-kNBnMh6qJGMn6KafoOFH7D7cp4pMTMFu1ufYA6zKwrFE~Nkz0zvmih9NLMEGm3JYxHaxNBDsW8KSm8sSLasM~L2rj~6veq3J-7EjW~DVLlAZQ__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E03_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 4,
    "url": "https://cacdn.hakunaymatata.com/subtitle/398a4c2a51b4dd63bec1efcfb7cc275a.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI2NDc1fX19XX0_&Signature=bZhkZ5zG~LLHlZ2I9vxY7RxmkIFuAnUx-cTdXe~q1RJiG5JSQTj7BNBlXjm3N9y5Z-NW5MZ8FekNmw3RTyWbihcow6zyQ~fz5LM5bpuuA7xs8FfSegcDmQ8FF4KTrT7SOSbBMWMSaY3hdW9SfGv09~lrwrfnNJqYvRBD65nCd2Thiq6-TdJUI-jwWXdvbdjX1OD5cEnBeI7MoBAD2JEp74IunXDpbRSA4y74OHfHlcDmnik-AkuKSgEIbW-7B18HKVi0EX2iAyDVfeI1tPZpmLMv5bW-cc1JhyYcgXdqE97wexEx4WgIexc9HvZEzhnUFIq4rxx~STlOBdRQlrz5Rw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E04.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 4,
    "url": "https://macdn.hakunaymatata.com/resource/352a8addb997b859d6a3cf9b12987462.mp4?Expires=1747231817&Signature=TeeANM~RXFpKgQP2ByaGPBep38-rznM33TSmojQwlkXmIr1lvWmTJVMHo0nVh1~9yLyvz7obSWFEqQ1ONglFQzb8ojKmMmlYHq~YM80ap3sLCBnit0YAQzECwE58LCBan2e6J1Aq-o4MtDa4D~sOHjmYnjA2FfHkfg4tjhm4nsNyBjofFWTz6R-Xsah4q0M41~adnJrUx6yD4eP8njBB~KbzTISR0C8I~tLtFJS9-TWhWujWxVi7EYIVjkbLsOQQGfy6wcbn3bdiTV1kP8m0KN9o2Hm09kPDWjbch-8f5Gy4NRRQeKhEmRHu~xKH011bC6MQA6bDjpV-MVTXgPslgw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E04_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 5,
    "url": "https://cacdn.hakunaymatata.com/subtitle/5498dd5b2563b81860f0353429e4557b.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4OTA1fX19XX0_&Signature=prQ-OD7zPFiRRPEzI2t-LzFdcShc-vQsHh22Pb2AqS5f1oHl5PK2oiW4wUSU-pqCnCzGVFlDBwGkuIPT-PJuHPR3kQqiONH5nnEWB1klg~gzMYYQoS9KIbFzLurzSbdO1YcUIminrxdWx6RTf6gzF2dnBd3mTbrXllPkMxdl2DReOH8tiOyOXq1jwdHxsFgecW~zHI7ep9mvTmpFfBSmf8sDE1LH9wE8RGa-1cNDNz2NpdoPM7FmGvFKkFeFnk4OBrdTzg9EI2mPd1zjr472r--~2NvVudRSnn0Zw8IH2JsE5HLFz3SSenxPR3j19aGMPx4EHombftBjko4yx9JQUA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E05.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 5,
    "url": "https://vgorigin.hakunaymatata.com/resource/82943b07aabefa27d7d0118948fdf351.mp4?Expires=1747230731&KeyName=wefeed&Signature=QgXRaMSqqxbYIlbHiqL51lYN1t8Vk_SQbspk-kb2SzmA3H3R1D3CEl-UsnfEy3u7qsq6aGWysU17gcaGMfLuDg",
    "fname": "You_S04E05_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 6,
    "url": "https://cacdn.hakunaymatata.com/subtitle/003f9a55c31365767e26b33dbb2096dc.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI2NDc1fX19XX0_&Signature=bZhkZ5zG~LLHlZ2I9vxY7RxmkIFuAnUx-cTdXe~q1RJiG5JSQTj7BNBlXjm3N9y5Z-NW5MZ8FekNmw3RTyWbihcow6zyQ~fz5LM5bpuuA7xs8FfSegcDmQ8FF4KTrT7SOSbBMWMSaY3hdW9SfGv09~lrwrfnNJqYvRBD65nCd2Thiq6-TdJUI-jwWXdvbdjX1OD5cEnBeI7MoBAD2JEp74IunXDpbRSA4y74OHfHlcDmnik-AkuKSgEIbW-7B18HKVi0EX2iAyDVfeI1tPZpmLMv5bW-cc1JhyYcgXdqE97wexEx4WgIexc9HvZEzhnUFIq4rxx~STlOBdRQlrz5Rw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E06.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 6,
    "url": "https://macdn.hakunaymatata.com/resource/ebe3b1b60273026207ec2cc2dc55a558.mp4?Expires=1747234785&Signature=hwFmNcvbPiZseogfSM53cW6zsIODoSOthIs15HQMvXabgBKHsfp4aD8nKnn9sGsIYRaVtAgFpVBOCv-r-btJQJGiocpTETArWtQdZbgoQmYPrPh-SioHE5isHCE4IrIkU-OPx0LtV0WKYEdNcRua~0NLM8~Od~3QKMWOOzZ1hDGTz52x9C~X7dwnMMEui6x2jxwXl8liiOs2CTE0~jUuycLGwv3YQBKDVK-RoYvgFJlBL4q5Koql8DZ7S0-lLzPHdM9hegvxT-nIijI0lXe81L9NXyxmLgyHJPmw37k~Z~hz4Qy1iBNtcHw0NRM48KyTX4qX-Bg9ti-c1pHl-V7BGw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E06_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 7,
    "url": "https://cacdn.hakunaymatata.com/subtitle/55b7c05e78e01c4357041d51fa53d1c2.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E07.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 7,
    "url": "https://vgorigin.hakunaymatata.com/bt/5dd634978661b1373cc7adec3ce92d71.mp4?Expires=1747234817&KeyName=wefeed&Signature=WlEvkajeoPj1HzgsRkjJEoxuHuUwZajXSvUYFbTSgeFO2vT2JcLcSetxbVoRHbGFEODhNcHcu1x1jfu8BrPODA",
    "fname": "You_S04E07_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 8,
    "url": "https://cacdn.hakunaymatata.com/subtitle/73ce9b577aeaff8056ccb22193213d94.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4NjI5fX19XX0_&Signature=eV16nIkENX8JTRDlsAD4OPG8fyQ9ZzP2KLzhTiurcYp8N98f1PGJe-jDM2SRWNx-54jncWePLBRS-u8v7zyQj7HlgibGXUqKl9G5Eb2unUIxCjjcIbr0qiq9S7yAgRT2Goq3lhrwgUL9LF~3ZUyIObTy8S3AdVtFOlp2Uj3df9i7o33l7v3BSQLQIImyLZpODj98NqFVkwZZF5xe2w3A7Kv9fNbS6uFJU-7sHfp9JkQXWV7PR6CY6YbpMhp3opGL~rZX8UMUsZbVf4lVqQfZQwq-5asWzPDKzxyENw3qFUyMqpHD86phYjzrorAnbChGYGK5iuj0D7cCoin~myub1Q__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E08.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 8,
    "url": "https://vgorigin.hakunaymatata.com/resource/4dec6076d8eb4dab7bb6c765587e7262.mp4?Expires=1747231388&KeyName=wefeed&Signature=b3aRFILbu5VZn01SU0gjByDDbG1PVEUBpu7jrH8FGXRRrs7KdVwPD_5DxSmWiB80JsG-9aSMyDmquAZGDkWyDA",
    "fname": "You_S04E08_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 9,
    "url": "https://cacdn.hakunaymatata.com/subtitle/a5d49cf799514339ab363b51b4cce83c.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4NjM0fX19XX0_&Signature=38zeUV1sA2iT-Mfd0UfQ8lBVE7S3phrey68Q92UsYaUJ-ytkcI7ODZi4o-~lDhEpuafIopvB9gPxZnNwE0C6J2uWF8rKjQ6oTwxBolBYPbs6SuO5y9nwKPZHSXov~kJhTd7hz7xvOXPBlaY4YNFug8IkmYBd9TKFhEIVHstlBu578nuPfxccJzmNg5AmkjQF8UNR2P6FgQSEtiNRO69VptF05jRdRQewpsGk0yoFJoXLoRiJIYdsI0qQ0MvN5LSaK2R4FQPaLNeO9kdlMMuIa2g--iObt~0jsoOEURUQmAxjlHsFYtNq9RJZdtjJbNtw7djdif6Px8yddlEclvHDPw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E09.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 9,
    "url": "https://macdn.hakunaymatata.com/resource/6c34be66691b1c3e2969b7cf4694387f.mp4?Expires=1747233396&Signature=oTdRrLRavio0YWonTVyxbneDIS4PieAfRiixjy76qnSQ3Z8f5-mWaiJXBgNpSDhkEQUhKeqq4uL-nqY1CbtddXMF5KeLsr2LycxBUUojiROb4ycP1Ohi--D4leXDzcvZgoqHFLoENzr7sRaVSSeW~NzCdjssXWbJO8c3BQYQETad7uXOqdvGPPealfjnrslKhpEeDKIVeodWdx9QxXVRz6FcbPwqwcbN-pCGTKVoJZYlDKm~Ht2PBlLCjcYT9~AM4bEHMIzC9s2LhzR6B6SLE5pi991XjwhXnNN008z4f8iDvrbbpRXYwpJVks7ED6j4NPRFqWFbxSzw0wC9fYjfgg__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E09_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 4,
    "episode": 10,
    "url": "https://cacdn.hakunaymatata.com/subtitle/7649d36555b106b0c95b2b12b9d9325b.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4NjI5fX19XX0_&Signature=eV16nIkENX8JTRDlsAD4OPG8fyQ9ZzP2KLzhTiurcYp8N98f1PGJe-jDM2SRWNx-54jncWePLBRS-u8v7zyQj7HlgibGXUqKl9G5Eb2unUIxCjjcIbr0qiq9S7yAgRT2Goq3lhrwgUL9LF~3ZUyIObTy8S3AdVtFOlp2Uj3df9i7o33l7v3BSQLQIImyLZpODj98NqFVkwZZF5xe2w3A7Kv9fNbS6uFJU-7sHfp9JkQXWV7PR6CY6YbpMhp3opGL~rZX8UMUsZbVf4lVqQfZQwq-5asWzPDKzxyENw3qFUyMqpHD86phYjzrorAnbChGYGK5iuj0D7cCoin~myub1Q__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S04E10.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 4,
    "episode": 10,
    "url": "https://vgorigin.hakunaymatata.com/bt/5d807ccc4107b56ef4c0a02ba99b31bf.mp4?Expires=1747230967&KeyName=wefeed&Signature=mtYo15S4U123dE8ve-kEYe44tziSISCAIsV0GJs_CLSzRFYmzNc9RhJfZXR4E8EhajtIYCbmZeFnJIj5iy-8Bg",
    "fname": "You_S04E10_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 1,
    "url": "https://cacdn.hakunaymatata.com/subtitle/2cae86e7198e7a0819d38e634112577c.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E01.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 1,
    "url": "https://macdn.hakunaymatata.com/bt/d29cc6db50224ca73df63e86e4183f13.mp4?Expires=1747233917&Signature=OKBHBBZOCIGHD70pulj1bz~ul-aLmVuZhj1wwf8b3o2A-O1XYGF5oszpDyaz0zB6zqiAQs21RPMyKnG~hIsPWnT-~ct0LAQvlnZPhSV4wtScX75HvwfLT7XCCNHRwMGJngk4DI~2W3bOPZrWNJ~D6TswcmIWboOT0~CrHeGC2O5ma1pHOCFpfRxg5ov~RslVNBdZn8nzoVIteRmbnywmL2GmPnpSXo78TsH-HmX-DGHxrrSYNJGAe89sTYeRYSARW63oQxvH0Cet6TJnawX4EAzlBm9FaeLWMYo8MAEM9UGFexLzzdoNhYTurxojDgnT9jp5NDjlCtne4~6cbhK3Mg__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E01_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 2,
    "url": "https://cacdn.hakunaymatata.com/subtitle/cdd2bfc6923ece2e3d4e0eccd82f1f59.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjMwMDc1fX19XX0_&Signature=SH3JWQ5mIrAdbcEL2jGg~I4824WBob-jjfs6t79lojdiTcT4Dc7mpy6gT8KCd3sGfpwJkC4ekYaXJfe-dnl5UBJ3QBIdBxma~1DiTNpXsDHe0BihyxomB6-Brz-QDdsLlOP9jflcSSLm2UUutvSMP9tmjVRO7-CbsecQAIQqew6C6tsuTWrTloOZnFlPO8kdBdwtV853Q3GoF8gXqXXaB34dgMKzuBefWPc6pTJr~MU5RYyJIZ-JHIR~QpFzAv784jo3~ExbHsIjCtkckcP5pJCbtnzszHhr5Zt6r8B4fz3g2SGtclncVRuA0sKG4CTr1UfNu4ehkZxfP8R25gl4Ug__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E02.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 2,
    "url": "https://macdn.hakunaymatata.com/bt/139ed895b5a67064aabcea836fbc4f1c.mp4?Expires=1747234538&Signature=mVq4CeXDp~mCalG~FK3LkV5WmqvK1Nq3C8U-vShiSslXdLChpUq0Oc8KxCmA-vz2JAtCLUQzc-ODzNmr8sK48cV-hnJl6KTZSkVcB0gg85W8-IG6gmMAgjv8KsyoHb2FvVn~k3aW4RQsyz4PSa-D5qzcKZXtUfe4UB-~4e4XI-aGGjdpHhxGnQSToFu49YBb4ZD7qwbpcDLHP8WmrdAO--wHft4mpjYIb7M6JtL1Z-~~kt4c5JcSkwoUqpqvtA1aR~Gc5Z8S5PiVdYu51AzvgS~iUyDMp6beKuQxVcfu5e2NFfBrP9W1U8SoYIcouU9tZcfHVWGmjHpRSqlNuwCxcQ__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E02_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 3,
    "url": "https://cacdn.hakunaymatata.com/subtitle/fe189e90f5116d7d4f6385b77fd57ce0.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjMwMDc4fX19XX0_&Signature=ms988guBt45N2Q3KUm7pZPIaAX8KAHGwG5kYmKQNE0tbvj3eob4JZMDzfNTS13MGaJJ9ys3qlvSEGxgrPFi5vCAk0Een0som2jXCWbXrtkTbCAXaRCYcZXk0aZH6jQ9p5mbxJZcasdT9RbiKGiUN2CGtD-9Wr2LEDCR1yFblmkMNgw7b6JAK11i4J3Fpd1CEVvApmawLXjrDJ3FaTjKkT39uGax6ZNGlsTtndYRmqmf6phTnwlpu4DFDGA0QREzrAvxN4oMGmEQk82gKLPhsvcxlHeHNsjuMJK4tE9XMdJ6dHIAv1vcdtXYdj48dFTaB69fFHVGyKopnpCN54869~w__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E03.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 3,
    "url": "https://macdn.hakunaymatata.com/bt/3f4a5ed2f04ab1c7d92f708e577d57cc.mp4?Expires=1747231698&Signature=e1LeHzzc9fS3jDYugYhQaSl7oK3rBzoX3vm3HGp63S2tfZ4BOPJpiOWUNxyeT6OCPbxCV2l~GdIhlnyhiXcY5O3LpusaFRgoym8x1l3c31RX0kspzWbTMlCbBDfYokKzyz~S-uyovFnQgUH57Bva~TUqUGNcrMPDcjgdMaHzVq9Jtl7lpxgfndPueJDOJIk5TsFkJoZ10x~MCRpni5pdWH~7aja5Zx-llX5TwEJpQQIgVjb6V7cgg3v~P2FgeY5yeml6rNToA-rNYPchAPYCcBjgnpTfvbR15VPJpn5HhlOb24Sp4xqoIdgdbWg93Xz86gm8H1vMeWOiV6NNhEjEjw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E03_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 4,
    "url": "https://cacdn.hakunaymatata.com/subtitle/62e7e92f25e18fe1aa0ea32de014b7b6.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E04.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 4,
    "url": "https://macdn.hakunaymatata.com/bt/6835b0ccb23733835aeabbb7408c5dd5.mp4?Expires=1747234069&Signature=mAGwyex-SMa9-gGhFJ6zKt3Le7BlIudzrblqcRlzGD175iBf2TEjox1IedW54ratr98Xxp0Cv0AsJ0OWtmWDh8be5GvYXJ5oBZAFEsrilfnvbPeOjA1p-NUvJIy8JAqwF7NZVDXZ8HzW4tnfClXDYRd5FfENNkdRngpSt5efgorAdrcyYDXrEhNx1fLpKLOKQiIhXB7sqqYrB2OK8dMgO6SCxfqgDEsFNLTKoIU3iXTbxN8JWYwhxfOdvpRV2CTOvQtIhaIAgyqzB4oHoFaFpIlo--WEF-zzIzT7VppkMC0oXL2qjhNS36bHWvG9k6hMDCoDKVddC-lZ1wWtU45p3w__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E04_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 5,
    "url": "https://cacdn.hakunaymatata.com/subtitle/62151aa1d39ef980818adea77b879958.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E05.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 5,
    "url": "https://macdn.hakunaymatata.com/bt/e7ec45336990a4a35d37163c791d4af8.mp4?Expires=1747233092&Signature=K5EOdO7s2f1bO~ygyBaVENoAJ~pCjdteG4IpZcgl-WqUP9WR7gLlxPwGKWxhkx0HBEvq4IgBdcNbJqjO0UQbecRWyHgHCkWtOZfsJpwurR5hz8iv2VL8ltYs4BmBOPjdLbcVTRlgx4U~uWZyg7GYW9lfYQuyUTum1tEk00QymvX2mMvA1sFLwbI66PPMB05F5nN~ULDpb4ImqiVG2lr7O59Y~LBFeJGktFf7UfYSUH--BYam0wBgOtEMkKrREBSBgHaxn-SuDtYNL8ALo3DelB0syelUmyhezcMOTYaS0KD-58r6S5WkK2YzNFnH1SMMGMhqGGtQtUcIQpfVeDgcjw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E05_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 6,
    "url": "https://cacdn.hakunaymatata.com/subtitle/e4963617824acbda9041eb38a12ba32f.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4MjA5fX19XX0_&Signature=XPQwiEXDRFdbiP~9Cnipa4~P-~644K1kG3Pdl8UzjDeXUqHhLpeyf30Lw08n0qOsancEBvks0P2OuonhXCCSMb8-5w5a7C54DxMjqXdCmQPeApkkGynbBk32kOQh1DfzvbpYMvcmHk-VeBBu2MqL9TudQ2zEtMLqWB1neDJSqV5RCDsythZQIe0QdSsfNtKHXS1qlQgBpqrerMVbwKmkW9sDn0hK~6xp6QzdPpF-tJoUkiM7xbL89HzkpEcUCfR2TVODewRnaGbyPray774t1x-6-~E-e3LPqKmK5yIxbpn~TAuwZgMqUtDZn00X0UajwslnwhIRPfqeL4D5HYZ9Qw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E06.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 6,
    "url": "https://macdn.hakunaymatata.com/bt/fda4959178e59b8c5fbd1326a75beb45.mp4?Expires=1747232084&Signature=UP-acoLUZWBL0tEnL46zk~SuHMST0Hd8O~KWwIZ3zvjYeISRXE2D~RxEBKzkHg1Z9x2aBXX2sB-iRc5Dq60xeOyltqAtq8JTgamg3UlAlN8q-4ZydmZiB-m-m3mNo2Pj46y7NlJzkl-wXQ7~z5bcsoQQ~uAJLaEd4LJxoF6RhPD4ibIE7NhbhPjwxwjKySBDvz-Cocx2f2639LE5Jn7Uu34jbkzqfSqZWPzuEJDWCq~xsBHCEaJP1m4UsCwSrB8lA929ZA~d8D~WXF3m7Cd8qDrFCZWyrTDf2s1E6yLlgcKjlSozQl7a3c6vaUCZbzaHb-SzMh8BLEed11OONtj3XQ__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E06_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 7,
    "url": "https://cacdn.hakunaymatata.com/subtitle/ba934f294f072f58a1b975c9404ed629.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4NjM0fX19XX0_&Signature=38zeUV1sA2iT-Mfd0UfQ8lBVE7S3phrey68Q92UsYaUJ-ytkcI7ODZi4o-~lDhEpuafIopvB9gPxZnNwE0C6J2uWF8rKjQ6oTwxBolBYPbs6SuO5y9nwKPZHSXov~kJhTd7hz7xvOXPBlaY4YNFug8IkmYBd9TKFhEIVHstlBu578nuPfxccJzmNg5AmkjQF8UNR2P6FgQSEtiNRO69VptF05jRdRQewpsGk0yoFJoXLoRiJIYdsI0qQ0MvN5LSaK2R4FQPaLNeO9kdlMMuIa2g--iObt~0jsoOEURUQmAxjlHsFYtNq9RJZdtjJbNtw7djdif6Px8yddlEclvHDPw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E07.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 7,
    "url": "https://macdn.hakunaymatata.com/bt/40f0d2a2e44f315e5b9cfed4ddad4862.mp4?Expires=1747232148&Signature=fA9gK8rvUmib94kwIsrghKdxvDLMseNhSGCXEgUNHVEHMRda2Dhwbv67mmJR3Z51KWuBCNpQi1~0ZQdtBHO5bTTSLNa1uPCXSNLK9flo-W6jSdU0vJ-SASGJk0TxDazEkEIodM1O9VA~8RTRii3hkPNXzjx0bREjDyUnFMNZCyto4udVFc5~4TpHuLbOdOaYqVhv5ZxH4ZdlxledCWvgYt5ToStRQbUIkZJbmlgJpBMUy39jrKZrzHVckVIaxdpQX1cqyBkV1bn04fBDMXdVBtfUBOVBr7e6o6Nzm-gYlXuAIpxnS7RCSaoA72q0Wrwsi~XYD52MCQhhv82bVWViEQ__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E07_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 8,
    "url": "https://cacdn.hakunaymatata.com/subtitle/9ced5395eefa93dfb67a1e1caa9a01d8.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI3MTg3fX19XX0_&Signature=GZol-2tr3ciXt5yweZ6KuWVFp5K~3xV~WmY45EDmbyaG5S~H1iDRUYCVfYcbYNjGpqKIWyJaB37fDrf8P~MJcrMRcXjZulVPK3YqT3nN0pukSmsA2hUko7QzcKkmDy16NriGefydAnZOgOfMqeEqLapM3l4N0z8ep6rAPqU7YHCkp5URAlJBzj7X4J3-M8xK1EnxPbuOF6VtE9aI4akzMesuTvJuzK6z5cbCObhOIlJymFTJuSuPRixVSaTyCrFlhiubkX4QLYz7xNjjSV4UtYC7CSg3yrLjzzbvX85DPczsV-dLOPQXr~WTVkWEnLN5HwAMghHP~8l5fY-WPciCPA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E08.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 8,
    "url": "https://macdn.hakunaymatata.com/bt/f02ddf1920a68b8ab817d73bbd33198a.mp4?Expires=1747231279&Signature=vJ8WxTSa1~J-YbYzz2jFTBsVnQdRHglOFC8VA~lzRnf2Lp8i5AED8OhGhTHR-8rT1qQ1c9nM916peaQkXppFFw6BgjGNTubeRNGxMz6pJKyzOoXiW3MrFkhfhLYfmcKivNItU7OJ~fkG~lUfcl4qCOh6-a-q2whUiyOccUsbLaKn~6wg8Mh-zEkGMePKiJ72o19lgIoZ8YGrdgvtkcjwBjQW9iQj7o6CY-S9IIBaPTjBYNXMibrj4uelcQvZ~uMV7R1f4stnl0Ar5dit7BMKQT0ashkyrmzfUXKLppCrq3xyXcSrlX3QsnzudoMJcEtZKEQCsVjZ6Q8ap4zs7HyyrA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E08_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 9,
    "url": "https://cacdn.hakunaymatata.com/subtitle/a71d5b80d7246e86ada27fc25eee68bc.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI3MTg3fX19XX0_&Signature=GZol-2tr3ciXt5yweZ6KuWVFp5K~3xV~WmY45EDmbyaG5S~H1iDRUYCVfYcbYNjGpqKIWyJaB37fDrf8P~MJcrMRcXjZulVPK3YqT3nN0pukSmsA2hUko7QzcKkmDy16NriGefydAnZOgOfMqeEqLapM3l4N0z8ep6rAPqU7YHCkp5URAlJBzj7X4J3-M8xK1EnxPbuOF6VtE9aI4akzMesuTvJuzK6z5cbCObhOIlJymFTJuSuPRixVSaTyCrFlhiubkX4QLYz7xNjjSV4UtYC7CSg3yrLjzzbvX85DPczsV-dLOPQXr~WTVkWEnLN5HwAMghHP~8l5fY-WPciCPA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E09.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 9,
    "url": "https://macdn.hakunaymatata.com/bt/c72adefd529baf8302d8cb4a704c5221.mp4?Expires=1747234246&Signature=AcAcxsN~imoRivp2OeFU7vRO4eM-pk2Aj933mt5pXJqV8en-H9jHygAef5~xzHlfeMMi8GvxAQtlYkikRVOf02qZ34NNuw2E29Bw~t-5gSc4rgpIh8u3LUi8J012S2XZbcYOlwTSNinhE6fedcmRv5RMYKh~gkZl0~MHxCVVkXApZn1KvT5ShcNPFktRa83SK6FIhKo9K87gPqSnm1co7d6dpBZaDEbU8x0ELLbwyV-xqY~Pi~Nc4B7-MmoAmuKp4HL5bPj1gSoVHMoCpUvFJSoWJxDPJyxuV7ohncFETznBZYUwxgtdHoP36xCvUmQTyAEd6cWIhP1VCTRKDdO62w__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E09_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  },
  {
    "season": 5,
    "episode": 10,
    "url": "https://cacdn.hakunaymatata.com/subtitle/ed8f778056a7e7c9774a9128814a7972.srt?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9jYWNkbi5oYWt1bmF5bWF0YXRhLmNvbS9zdWJ0aXRsZS8qIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzQ2NjI4NjM0fX19XX0_&Signature=38zeUV1sA2iT-Mfd0UfQ8lBVE7S3phrey68Q92UsYaUJ-ytkcI7ODZi4o-~lDhEpuafIopvB9gPxZnNwE0C6J2uWF8rKjQ6oTwxBolBYPbs6SuO5y9nwKPZHSXov~kJhTd7hz7xvOXPBlaY4YNFug8IkmYBd9TKFhEIVHstlBu578nuPfxccJzmNg5AmkjQF8UNR2P6FgQSEtiNRO69VptF05jRdRQewpsGk0yoFJoXLoRiJIYdsI0qQ0MvN5LSaK2R4FQPaLNeO9kdlMMuIa2g--iObt~0jsoOEURUQmAxjlHsFYtNq9RJZdtjJbNtw7djdif6Px8yddlEclvHDPw__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E10.srt",
    "mediaType": "subtitle",
    "resolution": null
  },
  {
    "season": 5,
    "episode": 10,
    "url": "https://macdn.hakunaymatata.com/bt/610603566f1db4771217d24566291b25.mp4?Expires=1747231621&Signature=wCcbB9oS-cZ9gQSSOery25QCtRQl7PJ8vBoeqaMTGEQGhldVIJ3YKb4lKYyQeomEfYnlnIlzYgClMzZuXOgR21nSL-3QmFQQBoDWrcnrbZuKQ7Oqoe3gad5sIcfs3fGCZOwQuLamnAAHykxMyiEbaIo3RI2azvFK02O~CSXoIUGhZsBSO2eZMSic4KV4k1ZFSpbpUZ8mGyYOpfF9-VVKNtvWPaqIILYC9jRhy8DjgUXmmCjTqsWMB73cFzT8fxShT39UctbIf~FzKAWVHWwLvOcJx5I8I1x4G~y6WOBJXLUVUicxC-vqiMuFdHxamYMZnbu99foeUxsGjw8eggbBwA__&Key-Pair-Id=KMHN1LQ1HEUPL",
    "fname": "You_S05E10_480p.mp4",
    "mediaType": "video",
    "resolution": "480p"
  }
] || [
      { season: 1, episode: 1, fname: "Episode 1.mp4", url: "https://example.com/s01e01.mp4", resolution: "720p" },
      { season: 1, episode: 2, fname: "Episode 2.mp4", url: "https://example.com/s01e02.mp4", resolution: "1080p" },
      { season: 1, episode: 1, fname: "Episode 1 Subtitles.srt", url: "https://example.com/s01e01.srt" },
      { season: 2, episode: 1, fname: "Episode 1.mp4", url: "https://example.com/s02e01.mp4", resolution: "480p" }
    ];
    
    // User preferences
    const userPrefs = {
      preferredResolution: 'hd', // Default to HD
      darkMode: false,
      downloadDelay: 500,
      downloadQueue: [],
      isDownloading: false,
      downloadedFiles: new Set()
    };
    
    // Resolution mapping
    const resolutionMap = {
      '1080p': 'hd',
      '720p': 'hd',
      '480p': 'sd',
      '360p': 'lq',
      '240p': 'lq'
    };
    
    // Load saved preferences
    function loadPreferences() {
      const savedPrefs = localStorage.getItem('mediaDownloaderPrefs');
      if (savedPrefs) {
        try {
          const prefs = JSON.parse(savedPrefs);
          userPrefs.preferredResolution = prefs.preferredResolution || 'hd';
          userPrefs.darkMode = prefs.darkMode || false;
          userPrefs.downloadDelay = prefs.downloadDelay || 500;
          
          // Apply preferences
          document.getElementById('downloadDelay').value = userPrefs.downloadDelay;
          document.getElementById('delayValue').textContent = userPrefs.downloadDelay;
          
          if (userPrefs.darkMode) {
            document.body.classList.add('dark');
            document.getElementById('themeIcon').textContent = '☀️';
            document.getElementById('themeText').textContent = 'Light Mode';
          }
          
          // Set resolution option
          document.querySelectorAll('.resolution-option').forEach(opt => {
            opt.classList.remove('active');
          });
          document.getElementById(`res${userPrefs.preferredResolution.toUpperCase()}`).classList.add('active');
          
          // Load downloaded files history
          const downloadedHistory = localStorage.getItem('downloadedFiles');
          if (downloadedHistory) {
            userPrefs.downloadedFiles = new Set(JSON.parse(downloadedHistory));
          }
        } catch (e) {
          console.error("Error loading preferences:", e);
          localStorage.removeItem('mediaDownloaderPrefs');
        }
      }
    }
    
    // Save preferences
    function savePreferences() {
      const prefsToSave = {
        preferredResolution: userPrefs.preferredResolution,
        darkMode: userPrefs.darkMode,
        downloadDelay: userPrefs.downloadDelay
      };
      localStorage.setItem('mediaDownloaderPrefs', JSON.stringify(prefsToSave));
      
      // Save downloaded files history
      localStorage.setItem('downloadedFiles', JSON.stringify([...userPrefs.downloadedFiles]));
    }
    
    // Toggle dark mode
    function toggleDarkMode() {
      userPrefs.darkMode = !userPrefs.darkMode;
      document.body.classList.toggle('dark');
      
      const themeIcon = document.getElementById('themeIcon');
      const themeText = document.getElementById('themeText');
      
      if (userPrefs.darkMode) {
        themeIcon.textContent = '☀️';
        themeText.textContent = 'Light Mode';
      } else {
        themeIcon.textContent = '🌙';
        themeText.textContent = 'Dark Mode';
      }
      
      savePreferences();
    }
    
    // Set preferred resolution
    function setPreferredResolution(resolution) {
      userPrefs.preferredResolution = resolution;
      
      // Update UI
      document.querySelectorAll('.resolution-option').forEach(opt => {
        opt.classList.remove('active');
      });
      document.getElementById(`res${resolution.toUpperCase()}`).classList.add('active');
      
      savePreferences();
      showToast(`Preferred resolution set to ${resolution.toUpperCase()}`);
      populateEpisodeList(); // Refresh list to reflect resolution preference
    }

    // Determine media type from URL or filename
    function getMediaType(url, filename) {
      if (!url) return 'other';
      
      const lowerUrl = url.toLowerCase();
      const lowerFilename = filename ? filename.toLowerCase() : '';
      
      if (lowerUrl.includes('.srt') || lowerUrl.includes('.vtt') || 
          (lowerFilename && (lowerFilename.endsWith('.srt') || lowerFilename.endsWith('.vtt'))) ||
          lowerUrl.includes('/subtitle/')) {
        return 'subtitle';
      } else if (lowerUrl.includes('.mp4') || lowerUrl.includes('.mkv') || lowerUrl.includes('.avi') ||
                (lowerFilename && (lowerFilename.endsWith('.mp4') || lowerFilename.endsWith('.mkv') || lowerFilename.endsWith('.avi'))) ||
                lowerUrl.includes('video')) {
        return 'video';
      }
      return 'other';
    }
    
    // Determine resolution from URL or filename
    function getResolution(url, filename) {
      if (!url) return '480p';
      
      const lowerUrl = url.toLowerCase();
      const lowerFilename = filename ? filename.toLowerCase() : '';
      
      const resolutions = ['1080p', '720p', '480p', '360p', '240p'];
      for (const res of resolutions) {
        if (lowerUrl.includes(res) || (lowerFilename && lowerFilename.includes(res))) {
          return res;
        }
      }
      return '480p'; // Default to SD
    }

    // Get icon for media type
    function getMediaIcon(type) {
      switch(type) {
        case 'subtitle': return '📝';
        case 'video': return '🎬';
        default: return '📄';
      }
    }

    // Group episodes by season
    function groupBySeason() {
      const seasons = {};
      episodes.forEach(ep => {
        if (!seasons[ep.season]) {
          seasons[ep.season] = [];
        }
        seasons[ep.season].push(ep);
      });
      return seasons;
    }

    // Filter episodes based on resolution preference
    function filterEpisodesByResolution(episodes) {
      if (!userPrefs.preferredResolution) return episodes;
      
      return episodes.filter(ep => {
        const mediaType = ep.mediaType || getMediaType(ep.url, ep.fname);
        if (mediaType !== 'video') return true; // Only filter videos
        
        const resolution = ep.resolution || getResolution(ep.url, ep.fname);
        const resCategory = resolutionMap[resolution.toLowerCase()] || 'sd';
        return resCategory === userPrefs.preferredResolution;
      });
    }

    // Show toast notification
    function showToast(message, duration = 3000) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      
      toastMessage.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, duration);
    }

    // Search functionality
    function setupSearch() {
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        document.querySelectorAll('#episodeList li, [id^="season"][id$="List"] li').forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            item.style.display = '';
          } else {
            item.style.display = 'none';
          }
        });
      });
    }

    // Populate episode list
    function populateEpisodeList() {
      const allList = document.getElementById('episodeList');
      const seasonContainers = document.getElementById('seasonContainers');
      const count = document.getElementById('episodeCount');
      
      // Clear existing lists
      allList.innerHTML = '';
      seasonContainers.innerHTML = '';
      
      // Filter episodes based on resolution preference
      const filteredEpisodes = filterEpisodesByResolution(episodes);
      
      // Group episodes by season
      const seasons = groupBySeason();
      
      // Add all episodes to the main list
      filteredEpisodes.forEach(ep => {
        const mediaType = ep.mediaType || getMediaType(ep.url, ep.fname);
        const mediaIcon = getMediaIcon(mediaType);
        
        const resolution = ep.resolution || (mediaType === 'video' ? getResolution(ep.url, ep.fname) : null);
        const resolutionClass = resolution ? resolutionMap[resolution.toLowerCase()] || '' : '';
        
        const li = document.createElement('li');
        li.className = `media-item ${mediaType}`;
        li.dataset.resolution = resolution || '';
        
        // Mark as downloaded if in history
        if (userPrefs.downloadedFiles.has(ep.url)) {
          li.classList.add('downloaded');
        }
        
        let resolutionBadge = '';
        if (resolution) {
          resolutionBadge = `<span class="resolution-badge ${resolutionClass}">${resolution}</span>`;
        }
        
        const checkboxId = `ep_${ep.season}_${ep.episode}_${mediaType}_${resolution || 'default'}`.replace(/\s+/g, '_');
        
        li.innerHTML = `
          <input type="checkbox" class="epCb" id="${checkboxId}" 
                 value="${ep.url}" data-fname="${ep.fname}" 
                 data-season="${ep.season}" data-episode="${ep.episode}"
                 data-media-type="${mediaType}" data-resolution="${resolution || ''}">
          <label for="${checkboxId}">
            ${mediaIcon} S${ep.season.toString().padStart(2, '0')}E${ep.episode.toString().padStart(2, '0')}: ${ep.fname}
            <span class="media-type ${mediaType}">${mediaType}</span>
            ${resolutionBadge}
          </label>
          <div class="resolution-selector">
            ${mediaType === 'video' || mediaType === 'subtitle' ? `
              <button class="preview-btn" onclick="previewMedia('${ep.url}', '${mediaType}', 'S${ep.season}E${ep.episode}')">👁️ Preview</button>
            ` : ''}
          </div>
        `;
        allList.appendChild(li);
      });
      
      // Create season containers
      Object.keys(seasons).sort((a, b) => parseInt(a) - parseInt(b)).forEach(season => {
        const seasonEps = filterEpisodesByResolution(seasons[season]);
        if (seasonEps.length === 0) return; // Skip empty seasons
        
        const seasonDiv = document.createElement('div');
        seasonDiv.className = 'season-container';
        seasonDiv.innerHTML = `
          <div class="season-header" onclick="toggleSeason(${season})">
            <h2>Season ${season} <span class="season-badge">${seasonEps.length} Episodes</span></h2>
            <span class="chevron">▼</span>
          </div>
          <div class="season-content" id="season${season}Content">
            <div class="selection-controls" style="padding: 10px;">
              <button onclick="selectSeason(${season})">Select All Season ${season}</button>
              <button onclick="deselectSeason(${season})">Deselect Season ${season}</button>
            </div>
            <ul id="season${season}List">
              ${seasonEps.map(ep => {
                const mediaType = ep.mediaType || getMediaType(ep.url, ep.fname);
                const mediaIcon = getMediaIcon(mediaType);
                
                const resolution = ep.resolution || (mediaType === 'video' ? getResolution(ep.url, ep.fname) : null);
                const resolutionClass = resolution ? resolutionMap[resolution.toLowerCase()] || '' : '';
                
                let resolutionBadge = '';
                if (resolution) {
                  resolutionBadge = `<span class="resolution-badge ${resolutionClass}">${resolution}</span>`;
                }
                
                const checkboxId = `season_${season}_ep_${ep.episode}_${mediaType}_${resolution || 'default'}`.replace(/\s+/g, '_');
                
                const isDownloaded = userPrefs.downloadedFiles.has(ep.url);
                
                return `
                  <li class="media-item ${mediaType} ${isDownloaded ? 'downloaded' : ''}" data-resolution="${resolution || ''}">
                    <input type="checkbox" class="epCb seasonEp${season}" id="${checkboxId}" 
                           value="${ep.url}" data-fname="${ep.fname}"
                           data-season="${ep.season}" data-episode="${ep.episode}"
                           data-media-type="${mediaType}" data-resolution="${resolution || ''}">
                    <label for="${checkboxId}">
                      ${mediaIcon} Episode ${ep.episode}: ${ep.fname}
                      <span class="media-type ${mediaType}">${mediaType}</span>
                      ${resolutionBadge}
                    </label>
                    <div class="resolution-selector">
                      ${mediaType === 'video' || mediaType === 'subtitle' ? `
                        <button class="preview-btn" onclick="previewMedia('${ep.url}', '${mediaType}', 'S${season}E${ep.episode}')">👁️ Preview</button>
                      ` : ''}
                    </div>
                  </li>
                `;
              }).join('')}
            </ul>
          </div>
        `;
        seasonContainers.appendChild(seasonDiv);
      });
      
      // Update count
      count.textContent = `${filteredEpisodes.length} Episodes`;
      
      // Add event listeners to checkboxes
      document.querySelectorAll('.epCb').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          updateSelectedCount();
          
          const season = this.dataset.season;
          const episode = this.dataset.episode;
          const mediaType = this.dataset.mediaType;
          const resolution = this.dataset.resolution || 'default';
          const isChecked = this.checked;
          
          // Sync checkboxes in both views
          const mainCheckboxId = `ep_${season}_${episode}_${mediaType}_${resolution}`.replace(/\s+/g, '_');
          const seasonCheckboxId = `season_${season}_ep_${episode}_${mediaType}_${resolution}`.replace(/\s+/g, '_');
          
          const mainCheckbox = document.getElementById(mainCheckboxId);
          const seasonCheckbox = document.getElementById(seasonCheckboxId);
          
          if (mainCheckbox && mainCheckbox !== this) mainCheckbox.checked = isChecked;
          if (seasonCheckbox && seasonCheckbox !== this) seasonCheckbox.checked = isChecked;
        });
      });
      
      updateSelectedCount();
    }

    // Preview media
    async function previewMedia(url, mediaType, title) {
      const previewContainer = document.getElementById('previewContainer');
      const previewTitle = document.getElementById('previewTitle');
      const previewBody = document.getElementById('previewBody');
      
      previewTitle.textContent = `Preview: ${title}`;
      previewBody.innerHTML = '<div style="text-align: center; padding: 20px;">Loading preview...</div>';
      
      previewContainer.classList.add('active');
      
      try {
        if (mediaType === 'video') {
          previewBody.innerHTML = `
            <video class="preview-video" controls>
              <source src="${url}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          `;
          
          const video = previewBody.querySelector('video');
          video.onerror = function() {
            previewBody.innerHTML = `
              <div style="padding: 20px; text-align: center; color: var(--primary);">
                <p>Error loading video. The video might be protected or in an unsupported format.</p>
                <a href="${url}" target="_blank" class="download-btn" style="display: inline-block; margin-top: 10px;">
                  Try opening in new tab
                </a>
              </div>
            `;
          };
        } else if (mediaType === 'subtitle') {
          try {
            const response = await fetch(url);
            if (!response.ok) throw new Error(`Failed to fetch subtitle: ${response.status} ${response.statusText}`);
            
            const text = await response.text();
            previewBody.innerHTML = `<pre class="preview-subtitle">${text}</pre>`;
          } catch (error) {
            previewBody.innerHTML = `
              <div style="padding: 20px; text-align: center; color: var(--primary);">
                <p>Error loading subtitle: ${error.message}</p>
                <a href="${url}" target="_blank" class="download-btn" style="display: inline-block; margin-top: 10px;">
                  Try opening in new tab
                </a>
              </div>
            `;
          }
        } else {
          previewBody.innerHTML = `
            <div style="padding: 20px; text-align: center;">
              <p>Preview not available for this media type.</p>
              <a href="${url}" target="_blank" class="download-btn" style="display: inline-block; margin-top: 10px;">
                Open in new tab
              </a>
            </div>
          `;
        }
      } catch (error) {
        previewBody.innerHTML = `
          <div style="padding: 20px; text-align: center; color: var(--primary);">
            <p>Error loading preview: ${error.message}</p>
            <a href="${url}" target="_blank" class="download-btn" style="display: inline-block; margin-top: 10px;">
              Try opening in new tab
            </a>
          </div>
        `;
      }
    }

    // Close preview
    function closePreview() {
      const previewContainer = document.getElementById('previewContainer');
      const previewBody = document.getElementById('previewBody');
      
      previewContainer.classList.remove('active');
      setTimeout(() => {
        previewBody.innerHTML = '';
      }, 300);
    }

    // Filter media by type
    function filterMedia(type) {
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('active');
      
      document.querySelectorAll('#episodeList .media-item').forEach(item => {
        if (type === 'all' || item.classList.contains(type)) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
      
      document.querySelectorAll('[id^="season"][id$="List"] .media-item').forEach(item => {
        if (type === 'all' || item.classList.contains(type)) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
      
      showToast(`Showing ${type === 'all' ? 'all media' : type + ' files'}`);
    }

    // Toggle season content visibility
    function toggleSeason(season) {
      const content = document.getElementById(`season${season}Content`);
      const chevron = content.previousElementSibling.querySelector('.chevron');
      
      content.classList.toggle('open');
      chevron.classList.toggle('open');
    }

    // Select all episodes in a season
    function selectSeason(season) {
      document.querySelectorAll(`.seasonEp${season}`).forEach(checkbox => {
        if (checkbox.closest('li').style.display !== 'none') {
          checkbox.checked = true;
          
          const mainCheckboxId = `ep_${season}_${checkbox.dataset.episode}_${checkbox.dataset.mediaType}_${checkbox.dataset.resolution || 'default'}`.replace(/\s+/g, '_');
          const mainCheckbox = document.getElementById(mainCheckboxId);
          if (mainCheckbox) mainCheckbox.checked = true;
        }
      });
      
      updateSelectedCount();
      showToast(`Selected all visible episodes in Season ${season}`);
    }

    // Deselect all episodes in a season
    function deselectSeason(season) {
      document.querySelectorAll(`.seasonEp${season}`).forEach(checkbox => {
        checkbox.checked = false;
        
        const mainCheckboxId = `ep_${season}_${checkbox.dataset.episode}_${checkbox.dataset.mediaType}_${checkbox.dataset.resolution || 'default'}`.replace(/\s+/g, '_');
        const mainCheckbox = document.getElementById(mainCheckboxId);
        if (mainCheckbox) mainCheckbox.checked = false;
      });
      
      updateSelectedCount();
      showToast(`Deselected all episodes in Season ${season}`);
    }

    // Select all visible episodes
    function selectAll() {
      document.querySelectorAll('#episodeList .epCb').forEach(checkbox => {
        if (checkbox.closest('li').style.display !== 'none') {
          checkbox.checked = true;
          
          const season = checkbox.dataset.season;
          const episode = checkbox.dataset.episode;
          const mediaType = checkbox.dataset.mediaType;
          const resolution = checkbox.dataset.resolution || 'default';
          
          const seasonCheckboxId = `season_${season}_ep_${episode}_${mediaType}_${resolution}`.replace(/\s+/g, '_');
          const seasonCheckbox = document.getElementById(seasonCheckboxId);
          if (seasonCheckbox) seasonCheckbox.checked = true;
        }
      });
      
      updateSelectedCount();
      showToast('Selected all visible episodes');
    }

    // Deselect all episodes
    function deselectAll() {
      document.querySelectorAll('.epCb').forEach(checkbox => {
        checkbox.checked = false;
      });
      
      updateSelectedCount();
      showToast('Deselected all episodes');
    }

    // Parse season and episode from string like "S01E05"
    function parseSeasonEpisode(str) {
      const regex = /S(\d+)E(\d+)/i;
      const match = str.match(regex);
      if (match) {
        return {
          season: parseInt(match[1]),
          episode: parseInt(match[2])
        };
      }
      return null;
    }

    // Select episodes by range
    function selectRange() {
      const input = document.getElementById('rangeInput').value.trim();

      if (!input) {
        showToast('Please enter a valid range!', 3000);
        return;
      }

      // Deselect all first
      document.querySelectorAll('.epCb').forEach(checkbox => {
        checkbox.checked = false;
      });

      let start, end;
      let count = 0;

      if (input.includes('-')) {
        const [startStr, endStr] = input.split('-').map(s => s.trim());

        start = parseSeasonEpisode(startStr);
        if (!start) {
          showToast('Invalid start format! Use S01E02 format.', 3000);
          return;
        }

        if (endStr.toUpperCase().startsWith('E')) {
          const epNum = parseInt(endStr.substring(1));
          if (isNaN(epNum)) {
            showToast('Invalid end episode number!', 3000);
            return;
          }
          end = { season: start.season, episode: epNum };
        } else {
          end = parseSeasonEpisode(endStr);
          if (!end) {
            showToast('Invalid end format! Use S01E05 format.', 3000);
            return;
          }
        }
      } else {
        start = parseSeasonEpisode(input);
        if (!start) {
          showToast('Invalid format! Use S01E05 format.', 3000);
          return;
        }
        end = start;
      }

      // Validate range
      if (start.season > end.season || (start.season === end.season && start.episode > end.episode)) {
        showToast('Start episode must be before end episode!', 3000);
        return;
      }

      // Select episodes in range
      document.querySelectorAll('#episodeList .epCb').forEach(checkbox => {
        const season = parseInt(checkbox.dataset.season);
        const episode = parseInt(checkbox.dataset.episode);

        if (
          (season > start.season || (season === start.season && episode >= start.episode)) &&
          (season < end.season || (season === end.season && episode <= end.episode))
        ) {
          if (checkbox.closest('li').style.display !== 'none') {
            checkbox.checked = true;
            count++;

            const mediaType = checkbox.dataset.mediaType;
            const resolution = checkbox.dataset.resolution || 'default';
            const seasonCheckboxId = `season_${season}_ep_${episode}_${mediaType}_${resolution}`.replace(/\s+/g, '_');
            const seasonCheckbox = document.getElementById(seasonCheckboxId);
            if (seasonCheckbox) seasonCheckbox.checked = true;
          }
        }
      });

      updateSelectedCount();

      const rangeText = start.season === end.season && start.episode === end.episode
        ? `S${start.season.toString().padStart(2, '0')}E${start.episode.toString().padStart(2, '0')}`
        : `S${start.season.toString().padStart(2, '0')}E${start.episode.toString().padStart(2, '0')} to S${end.season.toString().padStart(2, '0')}E${end.episode.toString().padStart(2, '0')}`;

      showToast(`Selected ${count} episodes in range ${rangeText}`);
    }

    // Track selected count
    function updateSelectedCount() {
      const count = document.querySelectorAll('#episodeList input[type="checkbox"]:checked').length;
      const countElement = document.getElementById('selectedCount');
      countElement.textContent = count === 1 ? '1 selected' : `${count} selected`;
    }

    // Download selected episodes
    function downloadSelected() {
      const selectedCheckboxes = document.querySelectorAll('#episodeList input[type="checkbox"]:checked');
      
      if (selectedCheckboxes.length === 0) {
        showToast('Please select at least one episode to download!', 3000);
        return;
      }
      
      // Clear previous queue if any
      userPrefs.downloadQueue = [];
      
      // Build download queue
      selectedCheckboxes.forEach(checkbox => {
        userPrefs.downloadQueue.push({
          url: checkbox.value,
          filename: checkbox.dataset.fname,
          season: checkbox.dataset.season,
          episode: checkbox.dataset.episode,
          mediaType: checkbox.dataset.mediaType,
          resolution: checkbox.dataset.resolution || ''
        });
      });
      
      // Start download process
      if (!userPrefs.isDownloading) {
        userPrefs.isDownloading = true;
        showToast(`Starting download of ${userPrefs.downloadQueue.length} files...`);
        
        // Show progress bar
        const progressBar = document.getElementById('progressBar');
        const progressBarFill = document.getElementById('progressBarFill');
        const progressText = document.getElementById('progressText');
        
        progressBar.style.display = 'block';
        progressBarFill.style.width = '0%';
        progressText.textContent = `Preparing to download 0/${userPrefs.downloadQueue.length} files...`;
        
        // Start download process
        processDownloadQueue();
      }
    }

    // Process download queue
    function processDownloadQueue() {
      if (userPrefs.downloadQueue.length === 0) {
        // All downloads completed
        userPrefs.isDownloading = false;
        
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        
        progressText.textContent = 'All downloads completed!';
        setTimeout(() => {
          progressBar.style.display = 'none';
          progressText.textContent = '';
        }, 3000);
        
        showToast('All downloads completed!');
        return;
      }
      
      const item = userPrefs.downloadQueue.shift();
      const totalItems = document.querySelectorAll('#episodeList input[type="checkbox"]:checked').length;
      const completedItems = totalItems - userPrefs.downloadQueue.length - 1;
      const progress = Math.round((completedItems / totalItems) * 100);
      
      // Update progress
      const progressBarFill = document.getElementById('progressBarFill');
      const progressText = document.getElementById('progressText');
      
      progressBarFill.style.width = `${progress}%`;
      progressText.textContent = `Downloading ${completedItems + 1}/${totalItems}: ${item.filename}`;
      
      // Perform download using multiple methods for cross-browser compatibility
      downloadFile(item.url, item.filename)
        .then(() => {
          // Mark as downloaded
          userPrefs.downloadedFiles.add(item.url);
          savePreferences();
          
          // Mark item as downloaded in UI
          document.querySelectorAll(`input[value="${item.url}"]`).forEach(checkbox => {
            const li = checkbox.closest('li');
            if (li) li.classList.add('downloaded');
          });
          
          // Continue with next item after delay
          setTimeout(() => {
            processDownloadQueue();
          }, userPrefs.downloadDelay);
        })
        .catch(error => {
          console.error('Download error:', error);
          showToast(`Error downloading ${item.filename}. Trying alternative method...`);
          
          // Try alternative method
          fallbackDownload(item.url, item.filename);
          
          // Continue with next item after delay
          setTimeout(() => {
            processDownloadQueue();
          }, userPrefs.downloadDelay);
        });
    }

    // Download file using fetch API and blob
    async function downloadFile(url, filename) {
      try {
        // First try the modern approach with fetch
        const response = await fetch(url);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        
        const blob = await response.blob();
        const blobUrl = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = blobUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        
        // Clean up
        setTimeout(() => {
          document.body.removeChild(a);
          URL.revokeObjectURL(blobUrl);
        }, 100);
        
        return true;
      } catch (error) {
        console.warn('Primary download method failed:', error);
        throw error; // Let the caller handle the fallback
      }
    }

    // Fallback download methods for cross-browser compatibility
    function fallbackDownload(url, filename) {
      // Method 1: iframe approach
      try {
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = url;
        iframe.onload = function() {
          document.body.removeChild(iframe);
        };
        document.body.appendChild(iframe);
      } catch (e) {
        console.warn('iframe download method failed:', e);
      }
      
      // Method 2: window.open approach
      try {
        const newWindow = window.open(url, '_blank');
        if (newWindow) {
          setTimeout(() => {
            try {
              newWindow.focus();
            } catch (e) {
              console.warn('Could not focus new window:', e);
            }
          }, 500);
        }
      } catch (e) {
        console.warn('window.open download method failed:', e);
      }
      
      // Method 3: Direct link approach
      try {
        const a = document.createElement('a');
        a.href = url;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.download = filename || '';
        a.click();
      } catch (e) {
        console.warn('Direct link download method failed:', e);
      }
      
      // Method 4: XMLHttpRequest approach for older browsers
      try {
        const xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'blob';
        
        xhr.onload = function() {
          if (this.status === 200) {
            const blob = new Blob([this.response], { type: 'application/octet-stream' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
          }
        };
        
        xhr.send();
      } catch (e) {
        console.warn('XMLHttpRequest download method failed:', e);
      }
      
      // Inform user about manual download option
      showToast(`Download started for ${filename}. If it doesn't work, right-click and 'Save link as...'`, 5000);
    }

    // Add fade-in animation on page load
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelector('.container').style.animation = 'fadeIn 0.8s';

      // Load user preferences
      loadPreferences();

      // Setup search functionality
      setupSearch();

      // Open first season by default in season view
      const firstSeason = document.querySelector('.season-content');
      if (firstSeason) {
        firstSeason.classList.add('open');
        firstSeason.previousElementSibling.querySelector('.chevron').classList.add('open');
      }

      populateEpisodeList();
    });
  </script>
</body>
</html>